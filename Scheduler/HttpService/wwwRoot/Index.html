<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta http-equiv="EXPIRES" content="0">
	<meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
	<meta http-equiv="PRAGMA" content="NO-CACHE">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Visualutions Inc. Scheduler</title>
	<link href="Public/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<link href="Public/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
	<link href="Public/css/Site.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<div class="container-fluid">
		<div class="row" style="margin-top: 26px;">
			<div class="col-xs-12" id="main-content"></div>
		</div>
	</div>

	<!-- Templates -->
	<script id="job-index-tmpl" type="text/x-jquery-tmpl">
		<div class="panel panel-default panel-shadowed">
			<div class="panel-heading">Jobs</div>
			<table class="table table-condensed table-stripped">
				<thead>
					<tr>
						<th>Name</th>
						<th>Enabled</th>
						<th>&nbsp;</th>
					</tr>
				</thead>
				<tbody id="job-tbl-body"></tbody>
			</table>
		</div>
	</script>

	<script id="job-item-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td><%= name %></td>
			<td><i class="<% if(enabled === true) { print('fa fa-check'); } %>"></i></td>
			<td>
				<div class="btn-group btn-group-sm pull-right">
					<a href="#/jobs/start/<%= id %>" class="btn btn-default" title="Start Job"><i class="fa fa-fw fa-play"></i></a>
					<a href="#/jobs/history/<%= id %>" class="btn btn-default" title="History"><i class="fa fa-fw fa-history"></i></a>
					<a href="#/jobs/<%= id %>" class="btn btn-default" title="Edit"><i class="fa fa-fw fa-pencil"></i></a>
					<a href="#/jobs/delete/<%= id %>" class="btn btn-danger" title="Delete"><i class="fa fa-fw fa-times"></i></a>
				</div>
			</td>
		</tr>
	</script>

	<script id="job-loader-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td colspan="3" style="text-align: center"><span class="fa fa-spinner fa-pulse fa-3x "></span></td>
		</tr>
	</script>

	<script id="job-view-tmpl" type="text/x-jquery-tmpl">
		<div class="container-fluid">
			<div class="row">
				<div class="col-xs-12">
					<h3><%= name %></h3>
					<hr />
				</div>
			</div>
			<div class="row">
				<div class="col-xs-3">
					<div class="list-group">
						<a href="#/jobs/<%= id %>" class="list-group-item">General</a>
						<a href="#/jobs/steps/<%= id %>" class="list-group-item">Steps</a>
						<a href="#/jobs/schedules/<%= id %>" class="list-group-item">Schedules</a>
					</div>
				</div>
				<div class="col-xs-9" id="job-content"></div>
			</div>
		</div>
	</script>

	<script id="job-steps-tmpl" type="text/x-jquery-tmpl">
		<div class="panel panel-default panel-shadowed">
			<div class="panel-heading clearfix">
				<h4 class="panel-title pull-left">Job Steps</h4>
				<div class="btn-toolbar pull-right">
					<div class="btn-group btn-group-sm">
						<button type="button" class="btn btn-default btn-refresh" title="Refresh"><i class="fa fa-fw fa-refresh"></i></button>
					</div>
				</div>
			</div>
			<table class="table table-condensed table-hover">
				<thead>
					<tr>
						<th>Step</th>
						<th>Name</th>
						<th>Type</th>
					</tr>
				</thead>
				<tbody id="tbl-body"></tbody>
				<tfoot>
					<tr>
						<td colspan="3">
							<div class="btn-toolbar">
								<div class="btn-group btn-group-sm">
									<button type="button" class="btn btn-default btn-moveup"><i class="fa fa-fw fa-chevron-up"></i></button>
									<button type="button" class="btn btn-default btn-movedown"><i class="fa fa-fw fa-chevron-down"></i></button>
								</div>
								<div class="btn-group btn-group-sm pull-right">
									<button type="button" class="btn btn-default btn-newStep"><i class="fa fa-fw fa-plus"></i></button>
									<button type="button" class="btn btn-default btn-editStep"><i class="fa fa-fw fa-pencil"></i></button>
									<button type="button" class="btn btn-default btn-deleteStep"><i class="fa fa-fw fa-trash"></i></button>
								</div>
							</div>
						</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</script>

	<script id="job-step-detail-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td><%= stepId %></td>
			<td><%= name %></td>
			<td><%= subSystem %></td>
		</tr>
	</script>

	<script id="job-step-loader-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td colspan="3" style="text-align: center;"><span class="fa fa-spinner fa-pulse fa-2x "></span></td>
		</tr>
	</script>

	<script id="job-step-noresults-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td colspan="3" style="text-align: center"><h4>No Results Found</h4></td>
		</tr>
	</script>
	
	<script id="job-editor-tmpl" type="text/x-jquery-tmpl">
		<form class="form-horizontal">
			<div class="form-group">
				<label class="control-label col-xs-2">Name</label>
				<div class="col-xs-4">
					<input type="text" class="form-control input-sm" name="name" value="<%= name %>" />
				</div>
			</div>
			<div class="form-group">
				<label class="control-label col-xs-2">Description</label>
				<div class="col-xs-4">
					<textarea class="form-control" name="description"><%= description %></textarea>
				</div>
			</div>
			<div class="form-group">
				<label class="control-label col-xs-2">Enabled</label>
				<div class="col-xs-4">
					<input type="checkbox" name="enabled" <% if(enabled === true) { print('checked="checked"'); } %> />
				</div>
			</div>
			<div class="form-group">
				<div class="col-xs-offset-2 col-xs-4">
					<button type="button" class="btn btn-primary"><i class="fa fa-fw fa-save"></i> Save</button>
					<a href="#/jobs" class="btn btn-default">Cancel</a>
				</div>
			</div>
		</form>
	</script>

	<script id="job-start-tmpl" type="text/x-jquery-tmpl">

	</script>

	<script id="job-history-tmpl" type="text/x-jquery-tmpl">
		<div class="panel panel-default panel-shadowed">
			<div class="panel-heading clearfix">
				<h4 class="panel-title pull-left"><%= name %> History</h4>
				<div class="btn-toolbar pull-right">
					<div class="btn-group btn-group-sm">
						<button type="button" class="btn btn-default btn-refresh" title="Refresh"><i class="fa fa-fw fa-refresh"></i></button>
					</div>
					<div class="btn-group btn-group-sm">
						<a href="#/jobs" class="btn btn-default" title="Close"><i class="fa fa-fw fa-times"></i></a>
					</div>
				</div>
			</div>
			<table class="table table-condensed table-stripped">
				<thead>
					<tr>
						<th>Step</th>
						<th>Step Name</th>
						<th>Message</th>
						<th>Status</th>
						<th>Run Date</th>
						<th>Duration</th>
					</tr>
				</thead>
				<tbody id="tbl-body"></tbody>
				<tfoot>
					<tr><td colspan="6" id="results-pager"></td></tr>
				</tfoot>
			</table>
		</div>
	</script>

	<script id="job-history-detail-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td><%= stepId %></td>
			<td><%= stepName %></td>
			<td><%= message %></td>
			<td><%= runStatus %></td>
			<td><%= runDateTime %></td>
			<td><%= runDuration %></td>
		</tr>
	</script>

	<script id="job-history-loading-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td colspan="6" style="text-align: center"><span class="fa fa-spinner fa-pulse fa-3x "></span></td>
		</tr>
	</script>

	<script id="job-history-noresults-tmpl" type="text/x-jquery-tmpl">
		<tr>
			<td colspan="6" style="text-align: center"><h4>No Results Found</h4></td>
		</tr>
	</script>

	<script id="jobstep-edit-tmpl" type="text/x-jquery-tmpl">
		<div class="modal fade">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close btn-cancel" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4>Job Step - <%= name %></h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal">
							<div class="form-group">
								<label class="control-label col-xs-2">Name</label>
								<div class="col-xs-8">
									<input type="text" class="form-control input-sm" name="name" value="<%= name %>" />
								</div>
							</div>
							<div class="form-group">
								<label class="control-label col-xs-2">Type</label>
								<div class="col-xs-8">
									<select name="subSystem" class="form-control">
										<option></option>
										<option value="Empty" <% if(subSystem === "Empty") { print('selected="selected"'); } %>>Empty</option>
										<option value="CLRTask" <% if(subSystem === "CLRTask") { print('selected="selected"'); } %>>Execute Assembly</option>
										<option value="SqlTask" <% if(subSystem === "SqlTask") { print('selected="selected"'); } %>>Transact-SQL script</option>
										<option value="WebTask" <% if(subSystem === "WebTask") { print('selected="selected"'); } %>>Web Request Call</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label class="control-label col-xs-2">Command</label>
								<div class="col-xs-8">
									<textarea name="command" class="form-control"><%= command %></textarea>
								</div>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary btn-save"><i class="fa fa=fw fa-save"></i> Save</button>
						<button type="button" class="btn btn-default btn-cancel">Cancel</button>
					</div>
				</div>
			</div>
		</div>
	</script>

	<script id="schedule-edit-tmpl" type="text/x-jquery-tmpl">
		<div class="modal fade">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header"></div>
					<div class="modal-body"></div>
					<div class="modal-footer"></div>
				</div>
			</div>
		</div>
	</script>

	<script id="error-tmpl" type="text/x-jquery-tmpl">
		<div class="modal fade">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header bg-danger">
						<h3 class="modal-title">Error: <small><%= title %></small></h3>
					</div>
					<div class="modal-body">
						<p><span><%= status %>::</span><span><%= statusText %></span></p>
						<% if(data != null) {%>
						<div style="max-height: 200px; overflow: auto; margin-bottom: 6px; margin-top: 6px; padding: 6px; word-wrap: break-word;">
							<% _.forEach(_.keys(data), function(key) {
							%><p><strong><%= key %>:</strong> <%= data[key] %></p><%
							});%>
						</div>
						<%}%>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>
	</script>

	<script src="Public/js/lib/combined.min.js"></script>
	<script src="Public/js/Visualutions.Scheduler.js"></script>
</body>
</html>